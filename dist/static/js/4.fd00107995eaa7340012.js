webpackJsonp([4],{"F+O8":function(e,t){},fSNW:function(e,t){},jKLp:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("BO1k"),s=i.n(n),r=i("Gu7T"),l=i.n(r),a=i("o/zv"),o=i.n(a),c=(i("YaEn"),i("SQ6o")),u={data:function(){return{visible:!1,top:0,left:0,fixedTags:[],selectedTag:{}}},computed:{visitedViews:function(){return this.$store.state.viewsBar.visitedViews}},watch:{$route:function(){this.addViewTags(),this.moveToCurrentTag()},visible:function(e){e?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},mounted:function(){this.initTags(),this.addViewTags()},methods:{isActive:function(e){return e.path===this.$route.path},filterFixedViews:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=[];return e.forEach(function(e){if(e.fixed){var s=o.a.resolve(i,e.path);n.push({fullPath:s,path:s,name:e.name,fixed:e.meta&&e.meta.fixed})}if(e.children){var r=t.filterFixedViews(e.children,e.path);r.length>=1&&(n=[].concat(l()(n),l()(r)))}}),n},initTags:function(){var e=this.fixedTags=this.filterFixedViews(c.a.getDynamicRouters()),t=!0,i=!1,n=void 0;try{for(var r,l=s()(e);!(t=(r=l.next()).done);t=!0){var a=r.value;a.name&&this.$store.dispatch("addVisitedView",a)}}catch(e){i=!0,n=e}finally{try{!t&&l.return&&l.return()}finally{if(i)throw n}}},addViewTags:function(){return this.$route.name&&this.$store.dispatch("addView",this.$route),!1},moveToCurrentTag:function(){var e=this,t=this.$refs.tag;this.$nextTick(function(){var i=!0,n=!1,r=void 0;try{for(var l,a=s()(t);!(i=(l=a.next()).done);i=!0){var o=l.value;if(o.to.path===e.$route.path){e.moveToTarget(o),o.to.fullPath!==e.$route.fullPath&&e.$store.dispatch("updateVisitedView",e.$route);break}}}catch(e){n=!0,r=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}})},refreshSelectedTag:function(e){var t=e.fullPath;this.$router.replace({path:t})},closeSelectedTag:function(e){var t=this;this.$store.dispatch("delView",e).then(function(i){var n=i.visitedViews;if(t.isActive(e)){var s=n.slice(-1)[0];s?t.$router.push(s):t.$router.push("/")}})},closeOthersTags:function(){var e=this;this.$router.push(this.selectedTag),this.$store.dispatch("delOthersViews",this.selectedTag).then(function(){e.moveToCurrentTag()})},closeAllTags:function(e){var t=this;this.$store.dispatch("delAllViews").then(function(i){var n=i.visitedViews;t.fixedTags.some(function(t){return t.path===e.path})||t.toLastView(n,e)})},toLastView:function(e,t){var i=e.slice(-1)[0];i?this.$router.push(i):"首页"===t.name?this.$router.replace({path:t.fullPath}):this.$router.push("/")},openMenu:function(e,t){var i=this.$el.getBoundingClientRect().left,n=this.$el.offsetWidth+i-105,s=t.clientX+5;this.left=s>n?n:s,this.top=t.clientY,this.visible=!0,this.selectedTag=e},closeMenu:function(){this.visible=!1},handleScroll:function(e){var t=e.wheelDelta||40*-e.deltaY,i=this.$refs.scrollContainer.$refs.wrap;i.scrollLeft=i.scrollLeft+t/4},moveToTarget:function(e){var t=this.$refs.scrollContainer.$el.offsetWidth,i=this.$refs.scrollContainer.$refs.wrap,n=this.$refs.tag,s=null,r=null,l=null,a=null;n.length>0&&(s=n[0],r=n[n.length-1]);for(var o=0;o<n.length;o++)if(n[o]===e){0===o?a=n[o].length>1&&n[o+1]:o===n.length-1?l=n[o].length>1&&n[o-1]:(l=n[o-1],a=n[o+1]);break}if(s===e)i.scrollLeft=0;else if(r===e)i.scrollLeft=i.scrollWidth-t;else{var c=a.$el.offsetLeft+a.$el.offsetWidth+4,u=l.$el.offsetLeft-4;c>i.scrollLeft+t?i.scrollLeft=c-t:u<i.scrollLeft&&(i.scrollLeft=u)}}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"views-container"},[i("el-scrollbar",{ref:"scrollContainer",staticClass:"scroll-container",attrs:{vertical:!1},nativeOn:{wheel:function(t){return t.preventDefault(),e.handleScroll(t)}}},e._l(e.visitedViews,function(t){return i("router-link",{key:t.path,ref:"tag",refInFor:!0,staticClass:"tags-view-item",class:e.isActive(t)?"active":"",attrs:{to:{path:t.path,query:t.query,fullPath:t.fullPath,fixed:t.fixed},tag:"span"},nativeOn:{mouseup:function(i){return"button"in i&&1!==i.button?null:e.closeSelectedTag(t)},contextmenu:function(i){return i.preventDefault(),e.openMenu(t,i)}}},[e._v("\n      "+e._s(t.name)+"\n      "),t.fixed?e._e():i("span",{staticClass:"el-icon-close",on:{click:function(i){return i.preventDefault(),i.stopPropagation(),e.closeSelectedTag(t)}}})])}),1),e._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:e.left+"px",top:e.top+"px"}},[i("li",{on:{click:function(t){return e.refreshSelectedTag(e.selectedTag)}}},[e._v("刷新")]),e._v(" "),e.selectedTag.fixed?e._e():i("li",{on:{click:function(t){return e.closeSelectedTag(e.selectedTag)}}},[e._v("关闭")]),e._v(" "),i("li",{on:{click:e.closeOthersTags}},[e._v("关闭其他")]),e._v(" "),i("li",{on:{click:function(t){return e.closeAllTags(e.selectedTag)}}},[e._v("关闭所有")])])],1)},staticRenderFns:[]};var h=i("VU/8")(u,f,!1,function(e){i("fSNW"),i("F+O8")},"data-v-6d9e4824",null);t.default=h.exports}});
//# sourceMappingURL=4.fd00107995eaa7340012.js.map