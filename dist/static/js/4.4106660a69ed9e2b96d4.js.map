{"version":3,"sources":["webpack:///src/views/components/views-bar.vue","webpack:///./src/views/components/views-bar.vue?f84d","webpack:///./src/views/components/views-bar.vue"],"names":["views_bar","props","type","default","data","visible","top","left","fixedTags","selectedTag","currentViews","this","$route","name","computed","visitedViews","$store","state","viewsBar","watch","addViewTags","moveToCurrentTag","value","document","body","addEventListener","closeMenu","removeEventListener","mounted","initTags","methods","isActive","route","path","filterFixedViews","routes","_this","basePath","arguments","length","undefined","tags","forEach","fixed","tagPath","_path_browserify_0_0_1_path_browserify_default","a","resolve","push","fullPath","meta","children","tempTags","concat","toConsumableArray_default","auth","getDynamicRouters","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","get_iterator_default","next","done","tag","dispatch","err","return","_this2","$refs","$nextTick","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","$el","dataset","moveToTarget","refreshSelectedTag","view","$router","replace","closeTag","views","filter","closeSelectedTag","clickTag","_this3","then","_ref","latestView","slice","closeOthersTags","_this4","closeAllTags","_this5","_ref2","some","toLastView","openMenu","e","offsetLeft","getBoundingClientRect","maxLeft","offsetWidth","clientX","clientY","handleScroll","eventDelta","wheelDelta","deltaY","$scrollWrapper","scrollContainer","wrap","scrollLeft","currentTag","$containerWidth","tagList","firstTag","lastTag","prevTag","nextTag","i","scrollWidth","afterNextTagOffsetLeft","beforePrevTagOffsetLeft","tabClick","tab","console","log","removeView","components_views_bar","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","vertical","nativeOn","wheel","$event","preventDefault","_l","key","refInFor","closable","size","data-path","on","close","click","contextmenu","_v","_s","directives","rawName","expression","style","_e","tab-click","tab-remove","model","callback","$$v","label","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/4.4106660a69ed9e2b96d4.js","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"views-container\" v-if=\"type=='tag'\">\r\n      <el-scrollbar\r\n        ref=\"scrollContainer\"\r\n        :vertical=\"false\"\r\n        class=\"scroll-container\"\r\n        @wheel.native.prevent=\"handleScroll\"\r\n      >\r\n        <el-tag\r\n          v-for=\"tag in visitedViews\"\r\n          ref=\"tag\"\r\n          :type=\"isActive(tag)?'':'info'\"\r\n          :key=\"tag.path\"\r\n          :closable=\"!tag.fixed\"\r\n          size=\"medium\"\r\n          class=\"view-item\"\r\n          :data-path=\"tag.path\"\r\n          @close=\"closeTag(tag.path)\"\r\n          @click=\"clickTag(tag.path)\"\r\n          @contextmenu.prevent.native=\"openMenu(tag,$event)\"\r\n        >{{ tag.name }}</el-tag>\r\n      </el-scrollbar>\r\n\r\n      <ul v-show=\"visible\" :style=\"{left:left+'px',top:top+'px'}\" class=\"contextmenu\">\r\n        <li @click=\"refreshSelectedTag(selectedTag)\">刷新</li>\r\n        <li v-if=\"!(selectedTag.fixed)\" @click=\"closeSelectedTag(selectedTag)\">关闭</li>\r\n        <li @click=\"closeOthersTags\">关闭其他</li>\r\n        <li @click=\"closeAllTags(selectedTag)\">关闭所有</li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"tab-views\" v-if=\"type=='tab'\">\r\n      <el-tabs type=\"card\" v-model=\"currentViews\" @tab-click=\"tabClick\" @tab-remove=\"removeView\">\r\n        <el-tab-pane\r\n          ref=\"tag\"\r\n          v-for=\"tag in visitedViews\"\r\n          :data-path=\"tag.path\"\r\n          :key=\"tag.name\"\r\n          :label=\"tag.name\"\r\n          :closable=\"!tag.fixed\"\r\n          :name=\"tag.name\"\r\n          @contextmenu.prevent.native=\"openMenu(tag,$event)\"\r\n        ></el-tab-pane>\r\n      </el-tabs>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport path from \"path\";\r\nimport routerMap from \"@/router\";\r\nimport Auth from \"@/auth\";\r\n\r\nconst tagAndTagSpacing = 4;\r\n\r\nexport default {\r\n  props: {\r\n    type: {\r\n      default: \"tab\"\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      top: 0,\r\n      left: 0,\r\n      fixedTags: [],\r\n      selectedTag: {},\r\n      currentViews: this.$route.name\r\n    };\r\n  },\r\n  computed: {\r\n    visitedViews() {\r\n      return this.$store.state.viewsBar.visitedViews;\r\n    }\r\n  },\r\n  watch: {\r\n    $route() {\r\n      this.currentViews = this.$route.name;\r\n      this.addViewTags();\r\n      if (this.type == \"tag\") {\r\n        this.moveToCurrentTag();\r\n      }\r\n    },\r\n    visible(value) {\r\n      if (value) {\r\n        document.body.addEventListener(\"click\", this.closeMenu);\r\n      } else {\r\n        document.body.removeEventListener(\"click\", this.closeMenu);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initTags();\r\n    this.addViewTags();\r\n  },\r\n  methods: {\r\n    isActive(route) {\r\n      return route.path === this.$route.path;\r\n    },\r\n    filterFixedViews(routes, basePath = \"/\") {\r\n      let tags = [];\r\n      routes.forEach(route => {\r\n        if (route.fixed) {\r\n          const tagPath = path.resolve(basePath, route.path);\r\n          tags.push({\r\n            fullPath: tagPath,\r\n            path: tagPath,\r\n            name: route.name,\r\n            fixed: route.meta && route.meta.fixed\r\n          });\r\n        }\r\n        if (route.children) {\r\n          const tempTags = this.filterFixedViews(route.children, route.path);\r\n          if (tempTags.length >= 1) {\r\n            tags = [...tags, ...tempTags];\r\n          }\r\n        }\r\n      });\r\n      return tags;\r\n    },\r\n    initTags() {\r\n      const fixedTags = (this.fixedTags = this.filterFixedViews(\r\n        Auth.getDynamicRouters()\r\n      ));\r\n      for (const tag of fixedTags) {\r\n        if (tag.name) {\r\n          this.$store.dispatch(\"addVisitedView\", tag);\r\n        }\r\n      }\r\n    },\r\n    addViewTags() {\r\n      const { name } = this.$route;\r\n      if (name) {\r\n        this.$store.dispatch(\"addView\", this.$route);\r\n      }\r\n      return false;\r\n    },\r\n    moveToCurrentTag() {\r\n      const tags = this.$refs.tag;\r\n      this.$nextTick(() => {\r\n        for (const tag of tags) {\r\n          if (tag.$el.dataset.path === this.$route.path) {\r\n            this.moveToTarget(tag);\r\n\r\n            // when query is different then update\r\n            if (tag.fullPath !== this.$route.fullPath) {\r\n              this.$store.dispatch(\"updateVisitedView\", this.$route);\r\n            }\r\n            break;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    refreshSelectedTag(view) {\r\n      const { fullPath } = view;\r\n      if (fullPath == this.$route.fullPath) {\r\n        this.$router.replace(\"/\");\r\n        this.$router.replace(fullPath);\r\n        return;\r\n      }\r\n      this.$router.replace(fullPath);\r\n    },\r\n    closeTag(path) {\r\n      let views = this.visitedViews.filter(view => view.path == path)[0];\r\n      this.closeSelectedTag(views);\r\n    },\r\n    clickTag(path) {\r\n      if (this.$route.path != path) {\r\n        this.$router.push(path);\r\n      }\r\n    },\r\n    closeSelectedTag(view) {\r\n      this.$store.dispatch(\"delView\", view).then(({ visitedViews }) => {\r\n        if (this.isActive(view)) {\r\n          const latestView = visitedViews.slice(-1)[0];\r\n          if (latestView) {\r\n            this.$router.push(latestView.path);\r\n          } else {\r\n            this.$router.push(\"/\");\r\n          }\r\n        }\r\n      });\r\n    },\r\n    closeOthersTags() {\r\n      this.$router.push(this.selectedTag);\r\n      this.$store.dispatch(\"delOthersViews\", this.selectedTag).then(() => {\r\n        this.moveToCurrentTag();\r\n      });\r\n    },\r\n    closeAllTags(view) {\r\n      this.$store.dispatch(\"delAllViews\").then(({ visitedViews }) => {\r\n        if (this.fixedTags.some(tag => tag.path === view.path)) {\r\n          return;\r\n        }\r\n        this.toLastView(visitedViews, view);\r\n      });\r\n    },\r\n    toLastView(visitedViews, view) {\r\n      const latestView = visitedViews.slice(-1)[0];\r\n      if (latestView) {\r\n        this.$router.push(latestView);\r\n      } else {\r\n        // now the default is to redirect to the home page if there is no tags-view,\r\n        // you can adjust it according to your needs.\r\n        if (view.name === \"首页\") {\r\n          // to reload home page\r\n          this.$router.replace({ path: view.fullPath });\r\n        } else {\r\n          this.$router.push(\"/\");\r\n        }\r\n      }\r\n    },\r\n    openMenu(tag, e) {\r\n      const menuMinWidth = 105;\r\n      const offsetLeft = this.$el.getBoundingClientRect().left; // container margin left\r\n      const offsetWidth = this.$el.offsetWidth; // container width\r\n      const maxLeft = offsetWidth + offsetLeft - menuMinWidth; // left boundary\r\n      const left = e.clientX + 5; // 向右间距5px\r\n\r\n      if (left > maxLeft) {\r\n        this.left = maxLeft;\r\n      } else {\r\n        this.left = left;\r\n      }\r\n      this.top = e.clientY;\r\n\r\n      this.visible = true;\r\n      this.selectedTag = tag;\r\n    },\r\n    closeMenu() {\r\n      this.visible = false;\r\n    },\r\n    handleScroll(e) {\r\n      const eventDelta = -e.wheelDelta || -e.deltaY * 40;\r\n      const $scrollWrapper = this.$refs.scrollContainer.$refs.wrap;\r\n      $scrollWrapper.scrollLeft = $scrollWrapper.scrollLeft + eventDelta / 4;\r\n    },\r\n    moveToTarget(currentTag) {\r\n      const $container = this.$refs.scrollContainer.$el;\r\n      const $containerWidth = $container.offsetWidth;\r\n      const $scrollWrapper = this.$refs.scrollContainer.$refs.wrap;\r\n      const tagList = this.$refs.tag;\r\n\r\n      let firstTag = null;\r\n      let lastTag = null;\r\n      let prevTag = null;\r\n      let nextTag = null;\r\n\r\n      // find first tag and last tag\r\n      if (tagList.length > 0) {\r\n        firstTag = tagList[0];\r\n        lastTag = tagList[tagList.length - 1];\r\n      }\r\n\r\n      // find preTag and nextTag\r\n      for (let i = 0; i < tagList.length; i++) {\r\n        if (tagList[i] === currentTag) {\r\n          if (i === 0) {\r\n            nextTag = tagList[i].length > 1 && tagList[i + 1];\r\n          } else if (i === tagList.length - 1) {\r\n            prevTag = tagList[i].length > 1 && tagList[i - 1];\r\n          } else {\r\n            prevTag = tagList[i - 1];\r\n            nextTag = tagList[i + 1];\r\n          }\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (firstTag === currentTag) {\r\n        $scrollWrapper.scrollLeft = 0;\r\n      } else if (lastTag === currentTag) {\r\n        $scrollWrapper.scrollLeft =\r\n          $scrollWrapper.scrollWidth - $containerWidth;\r\n      } else {\r\n        // the tag's offsetLeft after of nextTag\r\n        const afterNextTagOffsetLeft =\r\n          nextTag.$el.offsetLeft + nextTag.$el.offsetWidth + tagAndTagSpacing;\r\n\r\n        // the tag's offsetLeft before of prevTag\r\n        const beforePrevTagOffsetLeft =\r\n          prevTag.$el.offsetLeft - tagAndTagSpacing;\r\n\r\n        if (\r\n          afterNextTagOffsetLeft >\r\n          $scrollWrapper.scrollLeft + $containerWidth\r\n        ) {\r\n          $scrollWrapper.scrollLeft = afterNextTagOffsetLeft - $containerWidth;\r\n        } else if (beforePrevTagOffsetLeft < $scrollWrapper.scrollLeft) {\r\n          $scrollWrapper.scrollLeft = beforePrevTagOffsetLeft;\r\n        }\r\n      }\r\n    },\r\n    tabClick: function(tab) {\r\n      const path = tab.$el.dataset.path;\r\n      if (this.$route.path != path) {\r\n        this.$router.push(path);\r\n        console.log(path);\r\n      }\r\n    },\r\n    removeView: function(name) {\r\n      let views = this.visitedViews.filter(view => view.name == name)[0];\r\n      this.closeSelectedTag(views);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n.views-container {\r\n  height: 35px;\r\n  width: 100%;\r\n  background: #fff;\r\n  border-bottom: 1px solid #d8dce5;\r\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 0 3px 0 rgba(0, 0, 0, 0.04);\r\n  margin-top: -1px;\r\n  .scroll-container {\r\n    .view-item {\r\n      cursor: pointer;\r\n      margin-left: 5px;\r\n      margin-top: 4px;\r\n      &:first-of-type {\r\n        margin-left: 15px;\r\n      }\r\n      &:last-of-type {\r\n        margin-right: 15px;\r\n      }\r\n      &:hover {\r\n        background-color: rgb(236, 245, 255);\r\n        border-color: rgb(217, 236, 255);\r\n      }\r\n      // &.active {\r\n      //   background-color: #409eff;\r\n      //   color: #fff;\r\n      //   border-color: #409eff;\r\n      // }\r\n    }\r\n  }\r\n  .contextmenu {\r\n    margin: 0;\r\n    background: #fff;\r\n    z-index: 100;\r\n    position: absolute;\r\n    list-style-type: none;\r\n    padding: 5px 0;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    font-weight: 400;\r\n    color: #333;\r\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.3);\r\n    li {\r\n      margin: 0;\r\n      padding: 7px 16px;\r\n      cursor: pointer;\r\n      &:hover {\r\n        background: #eee;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\">\r\n.scroll-container {\r\n  .view-item {\r\n    .el-icon-close {\r\n      //   width: 16px;\r\n      //   height: 16px;\r\n      //   vertical-align: 2px;\r\n      //   border-radius: 50%;\r\n      //   text-align: center;\r\n      //   transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\r\n      //   transform-origin: 100% 50%;\r\n      //   &:before {\r\n      //     transform: scale(0.6);\r\n      //     display: inline-block;\r\n      //     vertical-align: -3px;\r\n      //   }\r\n      &:hover {\r\n        background-color: #f56c6c;\r\n        color: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.scroll-container {\r\n  height: 35px;\r\n  white-space: nowrap;\r\n  position: relative;\r\n  overflow: hidden;\r\n  /deep/ {\r\n    .el-scrollbar__bar {\r\n      bottom: 0px;\r\n    }\r\n    .el-scrollbar__wrap {\r\n      height: 49px;\r\n    }\r\n  }\r\n}\r\n\r\n.tab-views {\r\n  .el-tabs--card > .el-tabs__header {\r\n    border-bottom: 1px solid #f1f1f1;\r\n    .el-tabs__nav {\r\n      border: none !important;\r\n    }\r\n  }\r\n  .el-tabs__header {\r\n    margin: 0 !important;\r\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 0 3px 0 rgba(0, 0, 0, 0.04);\r\n    .el-tabs__item {\r\n      height: 34px;\r\n      line-height: 34px;\r\n      font-size: 12px;\r\n      border: none;\r\n      .el-icon-close:hover {\r\n        background-color: #f56c6c;\r\n      }\r\n    }\r\n    .el-tabs__item.is-active {\r\n      background-color: #f1f1f1;\r\n      height: 35px;\r\n      border-top: 2px solid #409eff;\r\n    }\r\n    .el-tabs__nav-next,\r\n    .el-tabs__nav-prev {\r\n      line-height: 35px;\r\n      color: #409eff;\r\n    }\r\n    .el-tabs__nav-prev {\r\n      border-right: 1px solid #f1f1f1;\r\n    }\r\n    .el-tabs__nav-next {\r\n      border-left: 1px solid #f1f1f1;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/components/views-bar.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.type=='tag')?_c('div',{staticClass:\"views-container\"},[_c('el-scrollbar',{ref:\"scrollContainer\",staticClass:\"scroll-container\",attrs:{\"vertical\":false},nativeOn:{\"wheel\":function($event){$event.preventDefault();return _vm.handleScroll($event)}}},_vm._l((_vm.visitedViews),function(tag){return _c('el-tag',{key:tag.path,ref:\"tag\",refInFor:true,staticClass:\"view-item\",attrs:{\"type\":_vm.isActive(tag)?'':'info',\"closable\":!tag.fixed,\"size\":\"medium\",\"data-path\":tag.path},on:{\"close\":function($event){return _vm.closeTag(tag.path)},\"click\":function($event){return _vm.clickTag(tag.path)}},nativeOn:{\"contextmenu\":function($event){$event.preventDefault();return _vm.openMenu(tag,$event)}}},[_vm._v(_vm._s(tag.name))])}),1),_vm._v(\" \"),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.visible),expression:\"visible\"}],staticClass:\"contextmenu\",style:({left:_vm.left+'px',top:_vm.top+'px'})},[_c('li',{on:{\"click\":function($event){return _vm.refreshSelectedTag(_vm.selectedTag)}}},[_vm._v(\"刷新\")]),_vm._v(\" \"),(!(_vm.selectedTag.fixed))?_c('li',{on:{\"click\":function($event){return _vm.closeSelectedTag(_vm.selectedTag)}}},[_vm._v(\"关闭\")]):_vm._e(),_vm._v(\" \"),_c('li',{on:{\"click\":_vm.closeOthersTags}},[_vm._v(\"关闭其他\")]),_vm._v(\" \"),_c('li',{on:{\"click\":function($event){return _vm.closeAllTags(_vm.selectedTag)}}},[_vm._v(\"关闭所有\")])])],1):_vm._e(),_vm._v(\" \"),(_vm.type=='tab')?_c('div',{staticClass:\"tab-views\"},[_c('el-tabs',{attrs:{\"type\":\"card\"},on:{\"tab-click\":_vm.tabClick,\"tab-remove\":_vm.removeView},model:{value:(_vm.currentViews),callback:function ($$v) {_vm.currentViews=$$v},expression:\"currentViews\"}},_vm._l((_vm.visitedViews),function(tag){return _c('el-tab-pane',{key:tag.name,ref:\"tag\",refInFor:true,attrs:{\"data-path\":tag.path,\"label\":tag.name,\"closable\":!tag.fixed,\"name\":tag.name},nativeOn:{\"contextmenu\":function($event){$event.preventDefault();return _vm.openMenu(tag,$event)}}})}),1)],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-132f73d5\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/components/views-bar.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-132f73d5\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./views-bar.vue\")\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-132f73d5\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=1!./views-bar.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./views-bar.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./views-bar.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-132f73d5\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./views-bar.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-132f73d5\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/components/views-bar.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}